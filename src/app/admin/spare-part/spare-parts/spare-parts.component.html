<dx-data-grid
  keyExpr="id"
  [dataSource]="spareParts"
  [showColumnLines]="true"
  [showRowLines]="true"
  [showBorders]="true"
  [allowColumnResizing]="true"
  [columnAutoWidth]="true"
  [rowAlternationEnabled]="true"
  (onExporting)="onExportClient($event)"
>
  <dxo-paging [pageSize]="10"></dxo-paging>
  <dxo-filter-row [visible]="true"></dxo-filter-row>
  <dxo-export [enabled]="true"></dxo-export>

  <dxo-toolbar>
    <dxi-item location="before">
      <button nz-button nzType="primary" (click)="openAddSparePartModal()">
        <span nz-icon nzType="plus"></span>
        Thêm mới
      </button>
    </dxi-item>

    <dxi-item name="exportButton"></dxi-item>
  </dxo-toolbar>

  <dxi-column dataField="partNumber" caption="Part Number"></dxi-column>
  <dxi-column dataField="galileoName" caption="Galileo Name"></dxi-column>
  <dxi-column dataField="name" caption="Name"></dxi-column>
  <dxi-column
    caption="QR Code"
    cellTemplate="qrCodeTemplate"
    [fixed]="true"
    fixedPosition="right"
  >
    <div
      *dxTemplate="let item of 'qrCodeTemplate'"
      style="text-align: center"
      (click)="openPrintQRModal(item)"
    >
      <nz-qrcode [nzValue]="item.data.partNumber" [nzSize]="50"></nz-qrcode>
    </div>
  </dxi-column>

  <dxo-paging [pageSize]="10"></dxo-paging>
  <dxo-pager
    [showPageSizeSelector]="true"
    [allowedPageSizes]="[10, 25, 50, 100]"
  >
  </dxo-pager>
</dx-data-grid>

<nz-modal [(nzVisible)]="isOpenAddSparePartModal" nzTitle="Thêm mới Spare Part">
  <ng-container *nzModalContent>
    <nz-table
      #basicTable
      [nzData]="['']"
      nzBordered
      [nzFrontPagination]="false"
    >
      <tbody>
        <tr>
          <td>Part Number</td>
          <td>
            <input
              nz-input
              placeholder="Part Number"
              [(ngModel)]="sparePartCreate.partNumber"
            />
          </td>
        </tr>
        <tr>
          <td>Galileo Name</td>
          <td>
            <input
              nz-input
              placeholder="Galileo Name"
              [(ngModel)]="sparePartCreate.galileoName"
            />
          </td>
        </tr>
        <tr>
          <td>Name</td>
          <td>
            <input
              nz-input
              placeholder="Name"
              [(ngModel)]="sparePartCreate.name"
            />
          </td>
        </tr>
      </tbody>
    </nz-table>
  </ng-container>
  <div *nzModalFooter>
    <button
      nz-button
      nzType="default"
      (click)="isOpenAddSparePartModal = false"
    >
      Đóng
    </button>
    <button
      nz-button
      nzType="primary"
      (click)="onCreateSparePart()"
      [nzLoading]="isConfirmLoading"
    >
      Tạo
    </button>
  </div>
</nz-modal>

<nz-modal [(nzVisible)]="isOpenPrintQRModal" nzTitle="Print QR card">
  <ng-container *nzModalContent>
    <div id="printLabel">
      <table class="qr-label">
        <tbody>
          <tr>
            <td style="text-align: center;">
              <qrcode
                [qrdata]="sparePartSelected?.partNumber"
                [allowEmptyString]="true"
                [cssClass]="'center'"
                [elementType]="'img'"
                [errorCorrectionLevel]="'M'"
                [margin]="4"
                [scale]="1"
                [width]="200"
                [title]="sparePartSelected?.partNumber"
              ></qrcode>
              <span>{{sparePartSelected?.partNumber}}</span>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </ng-container>
</nz-modal>
