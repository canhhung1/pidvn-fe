<div nz-row [nzGutter]="24">
  <div nz-col nzXs="16" nzSm="16" nzMd="16" nzLg="16">
    <nz-collapse>
      <nz-collapse-panel
        [nzHeader]="'Project: RE-T0001'"
        [nzActive]="true"
        [nzShowArrow]="true"
      >
        <nz-card style="width: 100%">
          <p>Card content</p>
          <p>Card content</p>
          <p>Card content</p>
        </nz-card>

        <br />

        <nz-collapse>
          <nz-collapse-panel
            [nzHeader]="'Progress'"
            [nzActive]="true"
            [nzShowArrow]="true"
          >
            <dx-data-grid
              keyExpr="id"
              #projectGrid
              [dataSource]="items"
              [showColumnLines]="true"
              [showRowLines]="true"
              [showBorders]="true"
              [allowColumnResizing]="true"
              [columnAutoWidth]="true"
              (onRowClick)="onRowClick($event)"
            >
              <dxi-column dataField="item" caption="Process"></dxi-column>
              <dxi-column dataField="content" caption="Content"></dxi-column>
              <dxi-column
                dataField="startPlan"
                caption="Start Plan"
              ></dxi-column>
              <dxi-column dataField="endPlan" caption="End Plan"></dxi-column>
              <dxi-column
                dataField="startAction"
                caption="Start Action"
              ></dxi-column>
              <dxi-column
                dataField="endAction"
                caption="End Action"
              ></dxi-column>

              <dxi-column
                caption="Tiến độ"
                cellTemplate="progressTemplate"
                [fixed]="true"
                fixedPosition="right"
              >
                <div
                  *dxTemplate="let item of 'progressTemplate'"
                  style="text-align: center"
                >
                  <div class="w3-light-grey .w3-round-small">
                    <div
                      class="w3-container w3-green .w3-round-small"
                      [style.width]="item.data.progress + '%'"
                    >
                      {{ item.data.progress }}%
                    </div>
                  </div>
                </div>
              </dxi-column>

              <dxo-master-detail [enabled]="true" template="detail">
              </dxo-master-detail>
              <div *dxTemplate="let item of 'detail'">
                <div class="master-detail-caption">
                  <span>Process: {{ item.data.item }}</span>
                  <nz-card style="width: 100%">
                    <p>Card content</p>
                    <p>Card content</p>
                    <p>Card content</p>
                  </nz-card>

                  <dx-tree-list
                    id="file"
                    [dataSource]="files"
                    [rootValue]="-1"
                    keyExpr="id"
                    parentIdExpr="parentId"
                    [showRowLines]="true"
                    [showBorders]="true"
                    [columnAutoWidth]="true"
                    [expandedRowKeys]="expandedRowKeys"
                    (onExpandedRowKeysChange)="onExpandedRowKeysChanged($event)">
                  >
                    <dxi-column dataField="name" caption="Name"></dxi-column>
                    <dxi-column dataField="path" dataType="Path"></dxi-column>
                    <dxi-column
                      dataField="fileName"
                      dataType="File"
                    ></dxi-column>
                  </dx-tree-list>
                </div>
              </div>
            </dx-data-grid> </nz-collapse-panel
        ></nz-collapse>
      </nz-collapse-panel>
    </nz-collapse>
  </div>
  <div nz-col nzXs="8" nzSm="8" nzMd="8" nzLg="8">
    <nz-collapse>
      <nz-collapse-panel
        [nzHeader]="'Project Activity'"
        [nzActive]="true"
        [nzShowArrow]="true"
      >
        <dx-data-grid
          keyExpr="id"
          #projectActivityGrid
          [dataSource]="activities"
          [showColumnLines]="true"
          [showRowLines]="true"
          [showBorders]="true"
          [allowColumnResizing]="true"
          [columnAutoWidth]="true"
        >
          <dxi-column dataField="createdAt" caption="Time"></dxi-column>
          <dxi-column dataField="content" caption="Content"></dxi-column>
          <dxi-column dataField="note" caption="Note"></dxi-column>
        </dx-data-grid>
      </nz-collapse-panel>
    </nz-collapse>
  </div>
</div>

<nz-modal
  [(nzVisible)]="isOpenProgressModal"
  [nzTitle]="'Progress: ' + progressSelected?.item"
  nzWidth="100%"
>
  <ng-container *nzModalContent>
    <nz-table
      [nzData]="['']"
      nzSize="small"
      nzBordered
      nzFrontPagination="false"
    >
      <tbody>
        <tr>
          <td>Nội dung</td>
          <td>{{ progressSelected.content }}</td>
        </tr>
        <tr>
          <td>Start Plant</td>
          <td>
            <nz-date-picker
              [(ngModel)]="progressSelected.startPlan"
            ></nz-date-picker>
          </td>
        </tr>
        <tr>
          <td>End Plant</td>
          <td>
            <nz-date-picker
              [(ngModel)]="progressSelected.endPlan"
            ></nz-date-picker>
          </td>
        </tr>
        <tr>
          <td>Start Act</td>
          <td>
            <nz-date-picker
              [(ngModel)]="progressSelected.startAction"
            ></nz-date-picker>
          </td>
        </tr>
        <tr>
          <td>End Act</td>
          <td>
            <nz-date-picker
              [(ngModel)]="progressSelected.endAction"
            ></nz-date-picker>
          </td>
        </tr>
        <tr>
          <td>Tiến độ</td>
          <td>
            <nz-progress
              [nzPercent]="progressSelected.progress"
              [nzSteps]="10"
              nzStrokeColor="#1890ff"
            ></nz-progress>
          </td>
        </tr>
        <tr>
          <td>File</td>
          <td></td>
        </tr>
      </tbody>
    </nz-table>
  </ng-container>
</nz-modal>
